name: rg creation

on:
  push:
    branches:
      - main
      - features/**
  workflow_dispatch:

env:
  RESOURCE_GROUP_NAME: ${{ secrets.RESOURCE_GROUP_NAME }}
  STORAGE_ACCOUNT_NAME: ${{ secrets.STORAGE_ACCOUNT_NAME }}
  CONTAINER_NAME: ${{ secrets.CONTAINER_NAME }}
  STATE_KEY: ${{ secrets.STATE_KEY }}

jobs: 
  terraform_plan:
    runs-on: raman
    steps:
      - name: checkout code
        uses: actions/checkout@v5
      - name: Azure account login
        uses: azure/login@v2
        with: 
          creds: ${{ secrets.AZURE_CREDENTIALS }}
      
      - name: HashiCorp - Setup Terraform
        uses: hashicorp/setup-terraform@v3
        with:
          terraform_version: latest
      
      - name: Terraform init azurerm backend
        uses: ahmedig/terraform-azurerm-backend@v4
        with:
          AZURE_CREDENTIALS: ${{ secrets.AZURE_CREDENTIALS }}
          RESOURCE_GROUP_NAME: ${{ secrets.RESOURCE_GROUP_NAME }}
          STORAGE_ACCOUNT_NAME: ${{ secrets.STORAGE_ACCOUNT_NAME }}
          CONTAINER_NAME: ${{ secrets.CONTAINER_NAME }}
          STATE_KEY: ${{ secrets.STATE_KEY }}
          
      - name: Validate Configuration
        uses: tf-actions/validate@v1
      
      - name: terraform plan
        uses: dflook/terraform-plan@v2
        with:
          path: my-terraform-config  


        
        







          
      
